<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reading dlf files • daisyrVis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reading dlf files">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">daisyrVis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.0000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/compare-simulated-and-measured-data.html">Compare simulated and measured data</a></li>
    <li><a class="dropdown-item" href="../articles/daisy-01-reading-dlf-files.html">Reading dlf files</a></li>
    <li><a class="dropdown-item" href="../articles/daisy-02-plotting-dlfs.html">Plotting dlfs</a></li>
    <li><a class="dropdown-item" href="../articles/mass-balance.html">Mass balance</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reading dlf files</h1>
            
      

      <div class="d-none name"><code>daisy-01-reading-dlf-files.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://daisy-model.github.io/daisyrVis/">daisyrVis</a></span><span class="op">)</span></span></code></pre></div>
<p>Daisy log files (.dlf) can be read with <code>read_dlf</code>.
<code>read_dlf</code> can read a single dlf file, a directory tree of
dlf files produced by the daisy spawn program, or a directory tree of
dlf files in any order.When called with just a path the function will
automatocally guess how it should process the path. You can also
explicitly control how the path is processed by setting the mode
parameter.</p>
<div class="section level2">
<h2 id="reading-a-single-dlf-file">Reading a single dlf file<a class="anchor" aria-label="anchor" href="#reading-a-single-dlf-file"></a>
</h2>
<p>We start by reading a single dlf file and inspect the contents. We
use the Soil chemical log that is bundled with
<code>daisyrVis</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"daisyrVis"</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"hourly/P2D-Daily-Soil_Chemical_110cm.dlf"</span><span class="op">)</span></span>
<span><span class="va">dlf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dlf.html">read_dlf</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></code></pre></div>
<p><code>read_dlf</code> returns an S4 object of class <code>Dlf</code>.
The data in the dlf file is stored in three <em>slots</em> in the
<code>Dlf</code> object, <code>header</code>, <code>units</code>,
<code>data</code></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">slotNames</span><span class="op">(</span><span class="va">dlf</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "header" "units"  "data"</span></span></code></pre></div>
<p>The <code>header</code> slot is a list of the metadata that is stored
before the actual data in the dlf file. The <code>units</code> slot is a
<code>data.frame</code> with unit information for each data column. The
<code>data</code> slot is a <code>data.frame</code> containing the data.
A slot is accessed with the <code>@</code> operator</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlf</span><span class="op">@</span><span class="va">header</span></span>
<span><span class="co">#&gt; $info</span></span>
<span><span class="co">#&gt; [1] "dlf-0.0 -- Soil chemical (defined in 'log-std.dai')."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $VERSION</span></span>
<span><span class="co">#&gt; [1] "6.41"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LOGFILE</span></span>
<span><span class="co">#&gt; [1] "P2D-Daily-Soil Chemical_110cm.dlf"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RUN</span></span>
<span><span class="co">#&gt; [1] "Thu Aug 31 10"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $COLUMN</span></span>
<span><span class="co">#&gt; [1] "*"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CHEMICAL</span></span>
<span><span class="co">#&gt; [1] "P2d"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $INTERVAL</span></span>
<span><span class="co">#&gt; [1] "box [-110; none]"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LOG</span></span>
<span><span class="co">#&gt; [1] "Content, transport and transformation of chemicals in the soil."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SIMFILE</span></span>
<span><span class="co">#&gt; [1] "Sim2-1d-Maize-P2p-d.dai"</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlf</span><span class="op">@</span><span class="va">units</span></span>
<span><span class="co">#&gt;   year month mday hour In_Matrix In_Biopores Leak_Matrix Leak_Biopores</span></span>
<span><span class="co">#&gt; 1                           g/ha        g/ha        g/ha          g/ha</span></span>
<span><span class="co">#&gt;   Biopores to matrix Matrix to biopores Tillage Drain_Soil Drain_Biopores</span></span>
<span><span class="co">#&gt; 1               g/ha               g/ha    g/ha       g/ha           g/ha</span></span>
<span><span class="co">#&gt;   Drain_Biopores_Indirect External Uptake Decompose Transform Content Biopores</span></span>
<span><span class="co">#&gt; 1                    g/ha     g/ha   g/ha      g/ha      g/ha    g/ha     g/ha</span></span>
<span><span class="co">#&gt;   Error time</span></span>
<span><span class="co">#&gt; 1  g/ha</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dlf</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year month mday hour In_Matrix In_Biopores  Leak_Matrix Leak_Biopores</span></span>
<span><span class="co">#&gt; 1 1995     1    1    0         0           0 -0.000208120             0</span></span>
<span><span class="co">#&gt; 2 1995     1    1    1         0           0 -0.000207217             0</span></span>
<span><span class="co">#&gt; 3 1995     1    1    2         0           0 -0.000206316             0</span></span>
<span><span class="co">#&gt; 4 1995     1    1    3         0           0 -0.000205415             0</span></span>
<span><span class="co">#&gt; 5 1995     1    1    4         0           0 -0.000204516             0</span></span>
<span><span class="co">#&gt; 6 1995     1    1    5         0           0 -0.000203618             0</span></span>
<span><span class="co">#&gt;   Biopores to matrix Matrix to biopores Tillage Drain_Soil Drain_Biopores</span></span>
<span><span class="co">#&gt; 1                  0                  0       0          0              0</span></span>
<span><span class="co">#&gt; 2                  0                  0       0          0              0</span></span>
<span><span class="co">#&gt; 3                  0                  0       0          0              0</span></span>
<span><span class="co">#&gt; 4                  0                  0       0          0              0</span></span>
<span><span class="co">#&gt; 5                  0                  0       0          0              0</span></span>
<span><span class="co">#&gt; 6                  0                  0       0          0              0</span></span>
<span><span class="co">#&gt;   Drain_Biopores_Indirect External Uptake  Decompose  Transform Content</span></span>
<span><span class="co">#&gt; 1                       0        0      0 0.00301612 0.00227715 60.5101</span></span>
<span><span class="co">#&gt; 2                       0        0      0 0.00300712 0.00225974 60.5095</span></span>
<span><span class="co">#&gt; 3                       0        0      0 0.00299438 0.00223681 60.5090</span></span>
<span><span class="co">#&gt; 4                       0        0      0 0.00297959 0.00221215 60.5084</span></span>
<span><span class="co">#&gt; 5                       0        0      0 0.00296299 0.00218613 60.5078</span></span>
<span><span class="co">#&gt; 6                       0        0      0 0.00294491 0.00215918 60.5073</span></span>
<span><span class="co">#&gt;      Biopores Error                time</span></span>
<span><span class="co">#&gt; 1 9.80239e-19     0 1995-01-01 00:00:00</span></span>
<span><span class="co">#&gt; 2 9.80239e-19     0 1995-01-01 01:00:00</span></span>
<span><span class="co">#&gt; 3 9.80239e-19     0 1995-01-01 02:00:00</span></span>
<span><span class="co">#&gt; 4 9.80239e-19     0 1995-01-01 03:00:00</span></span>
<span><span class="co">#&gt; 5 9.80239e-19     0 1995-01-01 04:00:00</span></span>
<span><span class="co">#&gt; 6 9.80239e-19     0 1995-01-01 05:00:00</span></span></code></pre></div>
<p>We can also directly access and assign columns of the
<code>data</code> slot with the <code>$</code> and <code>[[</code>
operators</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dlf</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1995 1995 1995 1995 1995 1995</span></span>
<span><span class="va">dlf</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="va">dlf</span><span class="op">$</span><span class="va">year</span> <span class="op">+</span> <span class="fl">2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dlf</span><span class="op">[[</span><span class="st">"year"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1997 1997 1997 1997 1997 1997</span></span>
<span><span class="va">dlf</span><span class="op">[[</span><span class="fl">1</span>, <span class="st">"year"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">dlf</span><span class="op">[[</span><span class="fl">1</span>, <span class="st">"year"</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> <span class="fl">10</span></span>
<span><span class="va">dlf</span><span class="op">[[</span><span class="fl">1</span>, <span class="st">"year"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 2007</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reading-a-depth-distributed-output">Reading a depth distributed output<a class="anchor" aria-label="anchor" href="#reading-a-depth-distributed-output"></a>
</h2>
<p>Some log files contain the distribution of a variable over depth and
time. By default, these a re detected and converted automatically by
<code>read_dlf</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"daisyrVis"</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"daily/DailyP/DailyP-Daily-WaterFlux.dlf"</span><span class="op">)</span></span>
<span><span class="va">dlf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dlf.html">read_dlf</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning while reading /home/runner/work/_temp/Library/daisyrVis/extdata/daily/DailyP/DailyP-Daily-WaterFlux.dlf</span></span>
<span><span class="co">#&gt; Data section starts at row 17</span></span>
<span><span class="co">#&gt; Discarded single-line footer: &lt;&lt;1990 4   28  0   0.892003    0.965204    0.992118    0.984267    0.995394    0.867143    0.665696    0.405031    0.360616    0.317983    0.256743    0.121373    0.00275476  -0.0963126  -0.175119   -0.255377   -0.33114    -0.403575   -0.444362   -0.485611   -0.51228    -0.53814    -0.557847   -0.571283   -0.578562   -0.580094&gt;&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dlf</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   z       time        q</span></span>
<span><span class="co">#&gt; 1 0 1990-04-02 0.686972</span></span>
<span><span class="co">#&gt; 2 0 1990-04-03 0.329720</span></span>
<span><span class="co">#&gt; 3 0 1990-04-04 0.569315</span></span>
<span><span class="co">#&gt; 4 0 1990-04-05 0.552182</span></span>
<span><span class="co">#&gt; 5 0 1990-04-06 0.804888</span></span>
<span><span class="co">#&gt; 6 0 1990-04-07 1.570560</span></span></code></pre></div>
<p>It is possible to disable this conversion</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dlf.html">read_dlf</a></span><span class="op">(</span><span class="va">path</span>, convert_depth<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning while reading /home/runner/work/_temp/Library/daisyrVis/extdata/daily/DailyP/DailyP-Daily-WaterFlux.dlf</span></span>
<span><span class="co">#&gt; Data section starts at row 17</span></span>
<span><span class="co">#&gt; Discarded single-line footer: &lt;&lt;1990 4   28  0   0.892003    0.965204    0.992118    0.984267    0.995394    0.867143    0.665696    0.405031    0.360616    0.317983    0.256743    0.121373    0.00275476  -0.0963126  -0.175119   -0.255377   -0.33114    -0.403575   -0.444362   -0.485611   -0.51228    -0.53814    -0.557847   -0.571283   -0.578562   -0.580094&gt;&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dlf</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year month mday hour q..AT..0 q..AT.._1 q..AT.._2 q..AT.._3 q..AT.._5.5</span></span>
<span><span class="co">#&gt; 1 1990     4    2    0 0.686972  0.664115  0.639810  0.613606    0.544964</span></span>
<span><span class="co">#&gt; 2 1990     4    3    0 0.329720  0.352970  0.366516  0.364938    0.348601</span></span>
<span><span class="co">#&gt; 3 1990     4    4    0 0.569315  0.516165  0.471405  0.439645    0.368329</span></span>
<span><span class="co">#&gt; 4 1990     4    5    0 0.552182  0.524524  0.498476  0.475034    0.417101</span></span>
<span><span class="co">#&gt; 5 1990     4    6    0 0.804888  0.646426  0.542673  0.485918    0.416079</span></span>
<span><span class="co">#&gt; 6 1990     4    7    0 1.570560  1.363380  1.210070  1.119550    0.930901</span></span>
<span><span class="co">#&gt;   q..AT.._10.5 q..AT.._17 q..AT.._25 q..AT.._27 q..AT.._29 q..AT.._32</span></span>
<span><span class="co">#&gt; 1     0.395473  0.1758390 -0.1373070 -0.1917510 -0.2467020  -0.330268</span></span>
<span><span class="co">#&gt; 2     0.282690  0.1381080 -0.1074000 -0.1521690 -0.1988810  -0.271746</span></span>
<span><span class="co">#&gt; 3     0.239977  0.0853382 -0.1161460 -0.1516110 -0.1881500  -0.245412</span></span>
<span><span class="co">#&gt; 4     0.299468  0.1396660 -0.0768022 -0.1141330 -0.1515970  -0.208488</span></span>
<span><span class="co">#&gt; 5     0.401543  0.2106090 -0.0299863 -0.0702949 -0.1097060  -0.168058</span></span>
<span><span class="co">#&gt; 6     0.630331  0.3376000  0.0331176 -0.0148375 -0.0595477  -0.123222</span></span>
<span><span class="co">#&gt;   q..AT.._41 q..AT.._51 q..AT.._61 q..AT.._70 q..AT.._80 q..AT.._90 q..AT.._100</span></span>
<span><span class="co">#&gt; 1  -0.559167  -0.754909  -0.884317  -0.942759  -0.932900  -0.843949   -0.702253</span></span>
<span><span class="co">#&gt; 2  -0.477825  -0.668107  -0.809770  -0.891153  -0.916981  -0.864004   -0.742204</span></span>
<span><span class="co">#&gt; 3  -0.417952  -0.596269  -0.741473  -0.836358  -0.888721  -0.869585   -0.774717</span></span>
<span><span class="co">#&gt; 4  -0.364315  -0.527612  -0.670777  -0.774113  -0.847243  -0.858932   -0.795311</span></span>
<span><span class="co">#&gt; 5  -0.317816  -0.468775  -0.604728  -0.709181  -0.794624  -0.830994   -0.799368</span></span>
<span><span class="co">#&gt; 6  -0.275118  -0.418583  -0.547307  -0.649482  -0.740437  -0.793534   -0.789338</span></span>
<span><span class="co">#&gt;   q..AT.._106 q..AT.._113 q..AT.._120 q..AT.._130 q..AT.._140 q..AT.._150</span></span>
<span><span class="co">#&gt; 1   -0.617684   -0.542156   -0.506693   -0.485376   -0.474339   -0.468794</span></span>
<span><span class="co">#&gt; 2   -0.658718   -0.575409   -0.531014   -0.500800   -0.483058   -0.472987</span></span>
<span><span class="co">#&gt; 3   -0.698181   -0.612140   -0.560251   -0.521052   -0.495913   -0.480430</span></span>
<span><span class="co">#&gt; 4   -0.731257   -0.648933   -0.592579   -0.545376   -0.512758   -0.491275</span></span>
<span><span class="co">#&gt; 5   -0.752059   -0.680330   -0.624036   -0.571390   -0.532342   -0.504967</span></span>
<span><span class="co">#&gt; 6   -0.759415   -0.702805   -0.650985   -0.596342   -0.552809   -0.520364</span></span>
<span><span class="co">#&gt;   q..AT.._160 q..AT.._170 q..AT.._180 q..AT.._190 q..AT.._200       time</span></span>
<span><span class="co">#&gt; 1   -0.465219   -0.461336   -0.455971   -0.448890   -0.440634 1990-04-02</span></span>
<span><span class="co">#&gt; 2   -0.466757   -0.461693   -0.456230   -0.449771   -0.442516 1990-04-03</span></span>
<span><span class="co">#&gt; 3   -0.470671   -0.463653   -0.457440   -0.451061   -0.444343 1990-04-04</span></span>
<span><span class="co">#&gt; 4   -0.477233   -0.467510   -0.459866   -0.452966   -0.446243 1990-04-05</span></span>
<span><span class="co">#&gt; 5   -0.486273   -0.473285   -0.463609   -0.455604   -0.448307 1990-04-06</span></span>
<span><span class="co">#&gt; 6   -0.497141   -0.480642   -0.468524   -0.458941   -0.450557 1990-04-07</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reading-daisy-spawn-output">Reading Daisy spawn output<a class="anchor" aria-label="anchor" href="#reading-daisy-spawn-output"></a>
</h2>
<p>Daisy spawn produces a directory hierarchy where each directory
contains the same log files. We use the Daisy spawn outputs that are
bundled with <code>daisyrVis</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"daisyrVis"</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"daisy-spawn-like"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">path</span>, recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Pig_JB1_Free/FWater200-Y.dlf"   "Pig_JB1_Free/Harvest.dlf"      </span></span>
<span><span class="co">#&gt;  [3] "Pig_JB6_Free/FWater200-Y.dlf"   "Pig_JB6_Free/Harvest.dlf"      </span></span>
<span><span class="co">#&gt;  [5] "Pig_JB6_Pipe/FWater200-Y.dlf"   "Pig_JB6_Pipe/Harvest.dlf"      </span></span>
<span><span class="co">#&gt;  [7] "Plant_JB1_Free/FWater200-Y.dlf" "Plant_JB1_Free/Harvest.dlf"    </span></span>
<span><span class="co">#&gt;  [9] "Plant_JB6_Free/FWater200-Y.dlf" "Plant_JB6_Free/Harvest.dlf"    </span></span>
<span><span class="co">#&gt; [11] "Plant_JB6_Pipe/FWater200-Y.dlf" "Plant_JB6_Pipe/Harvest.dlf"</span></span></code></pre></div>
<p>Notice that each directory contains the same log files.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dlf.html">read_dlf</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></code></pre></div>
<p>Instead of a single Dlf object, we now get a named list of Dlf
objects</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlf_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">)</span></span>
<span><span class="va">dlf_names</span></span>
<span><span class="co">#&gt; [1] "FWater200-Y" "Harvest"</span></span></code></pre></div>
<p>The list names correspond to the log types that was read. All logs of
the same type are concatenated together, and an extra column is added to
the data field. The name of the column is “sim” by default, but can be
set by passing <code>col_name="MySimulationName"</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">name</span> <span class="op">&lt;-</span> <span class="va">dlf_names</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   year month mday hour Precipitation Irrigation Potential evapotranspiration</span></span>
<span><span class="co">#&gt; 1 1998     4    1    1         0.000     0.0000                        0.000</span></span>
<span><span class="co">#&gt; 2 1999     4    1    0       780.275    32.0638                      432.102</span></span>
<span><span class="co">#&gt; 3 2000     4    1    0       694.900   154.1280                      540.430</span></span>
<span><span class="co">#&gt; 4 2001     4    1    0       613.400   120.0000                      461.553</span></span>
<span><span class="co">#&gt; 5 2002     4    1    0       741.100   182.0640                      555.994</span></span>
<span><span class="co">#&gt; 6 2003     4    1    0       667.500   152.0640                      550.955</span></span>
<span><span class="co">#&gt;   Actual evapotranspiration Matrix percolation Biopore percolation</span></span>
<span><span class="co">#&gt; 1                     0.000              0.000                   0</span></span>
<span><span class="co">#&gt; 2                   430.230            369.561                   0</span></span>
<span><span class="co">#&gt; 3                   525.957            310.769                   0</span></span>
<span><span class="co">#&gt; 4                   459.680            332.422                   0</span></span>
<span><span class="co">#&gt; 5                   554.361            352.533                   0</span></span>
<span><span class="co">#&gt; 6                   536.742            321.130                   0</span></span>
<span><span class="co">#&gt;   Matrix drain flow Biopore drain flow Runoff Biopore water Soil matrix water</span></span>
<span><span class="co">#&gt; 1                 0                  0      0             0           338.695</span></span>
<span><span class="co">#&gt; 2                 0                  0      0             0           351.230</span></span>
<span><span class="co">#&gt; 3                 0                  0      0             0           363.544</span></span>
<span><span class="co">#&gt; 4                 0                  0      0             0           304.808</span></span>
<span><span class="co">#&gt; 5                 0                  0      0             0           321.113</span></span>
<span><span class="co">#&gt; 6                 0                  0      0             0           282.804</span></span>
<span><span class="co">#&gt;   Surface water          sim                time</span></span>
<span><span class="co">#&gt; 1  -3.46945e-18 Pig_JB1_Free 1998-04-01 01:00:00</span></span>
<span><span class="co">#&gt; 2   1.27177e-02 Pig_JB1_Free 1999-04-01 00:00:00</span></span>
<span><span class="co">#&gt; 3   0.00000e+00 Pig_JB1_Free 2000-04-01 00:00:00</span></span>
<span><span class="co">#&gt; 4   3.43973e-02 Pig_JB1_Free 2001-04-01 00:00:00</span></span>
<span><span class="co">#&gt; 5   0.00000e+00 Pig_JB1_Free 2002-04-01 00:00:00</span></span>
<span><span class="co">#&gt; 6   0.00000e+00 Pig_JB1_Free 2003-04-01 00:00:00</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Pig_JB1_Free"   "Pig_JB6_Free"   "Pig_JB6_Pipe"   "Plant_JB1_Free"</span></span>
<span><span class="co">#&gt; [5] "Plant_JB6_Free" "Plant_JB6_Pipe"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reading-a-directory-with-dlf-files">Reading a directory with dlf files<a class="anchor" aria-label="anchor" href="#reading-a-directory-with-dlf-files"></a>
</h2>
<p>We use the tracer and field nitrogen logs that are bundled with
<code>daisyrVis</code> and read them with <code>read_dlf_dir</code></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"daisyrVis"</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"annual"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">path</span>, pattern<span class="op">=</span><span class="st">".*dlf"</span>, recursive<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Annual-FN/HourlyP-Annual-FN-2-2b.dlf"        </span></span>
<span><span class="co">#&gt; [2] "Annual-FN/HourlyP-Annual-FN-2-3b.dlf"        </span></span>
<span><span class="co">#&gt; [3] "Annual-FN/HourlyP-Annual-FN-2-4b.dlf"        </span></span>
<span><span class="co">#&gt; [4] "Annual-FN/HourlyP-Annual-FN-2-5b.dlf"        </span></span>
<span><span class="co">#&gt; [5] "Annual-Tracer/HourlyP-Annual-Tracer-2-2b.dlf"</span></span>
<span><span class="co">#&gt; [6] "Annual-Tracer/HourlyP-Annual-Tracer-2-3b.dlf"</span></span>
<span><span class="co">#&gt; [7] "Annual-Tracer/HourlyP-Annual-Tracer-2-4b.dlf"</span></span>
<span><span class="co">#&gt; [8] "Annual-Tracer/HourlyP-Annual-Tracer-2-5b.dlf"</span></span></code></pre></div>
<p>Notice that the directories contains a different set of log
files.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dlf.html">read_dlf</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></code></pre></div>
<p>Instead of a single Dlf object, we now get a named list of Dlf
objects</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Annual-FN/HourlyP-Annual-FN-2-2b"        </span></span>
<span><span class="co">#&gt; [2] "Annual-FN/HourlyP-Annual-FN-2-3b"        </span></span>
<span><span class="co">#&gt; [3] "Annual-FN/HourlyP-Annual-FN-2-4b"        </span></span>
<span><span class="co">#&gt; [4] "Annual-FN/HourlyP-Annual-FN-2-5b"        </span></span>
<span><span class="co">#&gt; [5] "Annual-Tracer/HourlyP-Annual-Tracer-2-2b"</span></span>
<span><span class="co">#&gt; [6] "Annual-Tracer/HourlyP-Annual-Tracer-2-3b"</span></span>
<span><span class="co">#&gt; [7] "Annual-Tracer/HourlyP-Annual-Tracer-2-4b"</span></span>
<span><span class="co">#&gt; [8] "Annual-Tracer/HourlyP-Annual-Tracer-2-5b"</span></span></code></pre></div>
<p>The list of names correspond to file paths, which can be a bit
unwieldly. We can either manually change the names or use the
convenience functions <code>drop_dir_from_names</code> and
<code>strip_common_prefix_from_names</code></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/drop_dir_from_names.html">drop_dir_from_names</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "HourlyP-Annual-FN-2-2b"     "HourlyP-Annual-FN-2-3b"    </span></span>
<span><span class="co">#&gt; [3] "HourlyP-Annual-FN-2-4b"     "HourlyP-Annual-FN-2-5b"    </span></span>
<span><span class="co">#&gt; [5] "HourlyP-Annual-Tracer-2-2b" "HourlyP-Annual-Tracer-2-3b"</span></span>
<span><span class="co">#&gt; [7] "HourlyP-Annual-Tracer-2-4b" "HourlyP-Annual-Tracer-2-5b"</span></span>
<span><span class="va">dlfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/strip_common_prefix_from_names.html">strip_common_prefix_from_names</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "FN-2-2b"     "FN-2-3b"     "FN-2-4b"     "FN-2-5b"     "Tracer-2-2b"</span></span>
<span><span class="co">#&gt; [6] "Tracer-2-3b" "Tracer-2-4b" "Tracer-2-5b"</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">name</span></span>
<span><span class="co">#&gt; [1] "FN-2-2b"</span></span>
<span><span class="va">dlfs</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">header</span></span>
<span><span class="co">#&gt; $info</span></span>
<span><span class="co">#&gt; [1] "dlf-0.0 -- Field nitrogen (defined in 'log-std.dai')."</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $VERSION</span></span>
<span><span class="co">#&gt; [1] "6.41"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LOGFILE</span></span>
<span><span class="co">#&gt; [1] "Annual-FN.dlf"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RUN</span></span>
<span><span class="co">#&gt; [1] "Mon Aug 28 16"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $COLUMN</span></span>
<span><span class="co">#&gt; [1] "*"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $INTERVAL</span></span>
<span><span class="co">#&gt; [1] "box none"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LOG</span></span>
<span><span class="co">#&gt; [1] "Nitrogen input, output, transformation and content for the system.\n\nThe intended use of this log is large scale nitrogen balance, for\nexample reservoir management. It provide information about how\nmuch nitrogen is in the field (down to a specified depth), where\nit is located in the field (surface, soil matrix or in biopores),\nwhat form is has (crop, soil organic matter, or mineral) as well\nas the sources, sinks and amounts of nitrogen entering or leaving\nthe system, and transformation between the four forms.  It does\nnot provide information about internal translocation of nitrogen\nbetween surface, soil matrix and biopores, use see the 'Soil\nnitrogen' log instead for that.\n\nFor the balances of this log to work, you must include the entire\nroot zone"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SIMFILE</span></span>
<span><span class="co">#&gt; [1] "Runfile2b.dai"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $SIM</span></span>
<span><span class="co">#&gt; [1] "Arable farm rotation; Soil"</span></span></code></pre></div>
<div class="section level3">
<h3 id="controlling-which-files-are-included">Controlling which files are included<a class="anchor" aria-label="anchor" href="#controlling-which-files-are-included"></a>
</h3>
<p><code>read_dlf</code> takes an optional pattern parameter that is
used for modes “spawn” and “dir” and controls which files are included.
By default all files with the suffix <code>.dlf</code> are included. If
we only want to read files ending with <code>2b.dlf</code>, we can
do</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package<span class="op">=</span><span class="st">"daisyrVis"</span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"annual"</span><span class="op">)</span></span>
<span><span class="va">dlfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_dlf.html">read_dlf</a></span><span class="op">(</span><span class="va">path</span>, pattern<span class="op">=</span><span class="st">".*2b\\.dlf"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dlfs</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Annual-FN/HourlyP-Annual-FN-2-2b"        </span></span>
<span><span class="co">#&gt; [2] "Annual-Tracer/HourlyP-Annual-Tracer-2-2b"</span></span></code></pre></div>
<p><code>pattern</code> is a regular expression. You should around with
it and see if you can find a shorter pattern that results in the same
files being read.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Silas Ørting.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
